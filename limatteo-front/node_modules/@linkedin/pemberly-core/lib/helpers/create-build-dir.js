const fs = require('fs-extra');
const SilentError = require('silent-error');

/**
 * Clean and create build folder
 *
 * @param {UI} ui
 * @param {Object} productInfo
 * @return {Promise}
 */
module.exports = async function createBuildDir(productInfo) {
  try {
    // clean build/pemberly-core
    await fs.remove(productInfo.pemberlyBuildDir);
    await fs.ensureDir(productInfo.pemberlyBuildDir);
    await fs.ensureDir(productInfo.publishDir); // for tgz and ivy
  } catch (e) {
    throw new SilentError(
      `[pre-pack]: Failed to create build dir: ${productInfo.buildDir}`
    );
  }
};
